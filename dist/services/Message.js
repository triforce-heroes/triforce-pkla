import{BufferConsumer as e}from"@triforce-heroes/triforce-core/BufferConsumer";export function messageDecrypt(r,t){let n=new e(r),f=(31881+10627*t)%65536,o=Buffer.allocUnsafe(r.length);for(let e=0;e<r.length;e+=2){let r=n.readUnsignedInt16()^f;o[e]=255&r,o[e+1]=r>>8,f=(f<<3|f>>13)%65536}let l=o.toString("ucs-2");return l.slice(0,l.length-1)}export function messageEncrypt(e,r){let t=Buffer.from(`${e}\0`,"ucs-2"),n=Buffer.allocUnsafe(t.length),f=(31881+10627*r)%65536;for(let e=0;e<t.length;e+=2)n[e]=t[e]^255&f,n[e+1]=t[e+1]^f>>8,f=(f<<3|f>>13)%65536;return n}