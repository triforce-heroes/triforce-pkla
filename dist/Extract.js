import{BufferConsumer as e}from"@triforce-heroes/triforce-core/BufferConsumer";import{messageDecrypt as n}from"./services/Message.js";export function extract(r,t){let s=new e(r),i=function(n){let r=new e(n,4),t=[],s=r.readUnsignedInt32();for(let e=0;e<s;e++){let e=r.readUnsignedInt64(),n=r.readUnsignedInt16(),s=r.readString(n-1);r.skip(1),t.push([e,s])}return t}(t),d=[];s.skip(2);let o=s.readUnsignedInt16();s.skip(4),s.skip(4),s.skip(4),s.skip(4);let a=new e(r,20+8*o);for(let e=0;e<o;e++){let[r,t]=i[e];s.skip(4);let o=s.readUnsignedInt16(),p=s.readUnsignedInt16();d.push({hash:r,name:t,flags:p,message:n(a.read(2*o),e)}),a.skipPadding(4)}return d}